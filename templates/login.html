<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Design by foolishdeveloper.com -->
    <title>Login Page</title>

    <!-- External stylesheets and fonts -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;600&display=swap" rel="stylesheet">

    <!-- Internal CSS styles -->
    <style media="screen">
        /* CSS styles for the login form and background */
        /* ... (CSS styles for the form and background) ... */
    </style>
</head>
<body>
<!-- Background shapes -->
<div class="background">
    <div class="shape"></div>
    <div class="shape"></div>
</div>

<!-- Login form -->
<form id="loginForm">
    <h3>Login Here</h3>

    <!-- Input fields for name and ID -->
    <label for="name">Name</label>
    <input type="text" placeholder="Your Name" id="name">

    <label for="id">ID</label>
    <input type="text" placeholder="Your ID" id="id">

    <!-- Error message for invalid ID -->
    <div id="errorMessage" style="display: none; color: red; margin-top: 10px;">Invalid ID. Please try again.</div>

    <!-- Submit button for the form -->
    <button type="submit">Log In</button>

    <!-- Social login options (currently commented out) -->
    <!-- <div class="social">
        <div class="go"><i class="fab fa-google"></i>  Google</div>
        <div class="fb"><i class="fab fa-facebook"></i>  Facebook</div>
    </div> -->
</form>

<!-- JavaScript code -->
<script>
    // Add an event listener to the form's submit event
    document.getElementById("loginForm").addEventListener("submit", async (event) => {
        event.preventDefault(); // Prevent the default form submission behavior

        // Get the values of the name and ID input fields
        const name = document.getElementById("name").value;
        const id = document.getElementById("id").value;

        // Create an object to hold the form data
        const loginData = {
            name: name,
            id: id,
        };

        // Send the form data as JSON to the backend using fetch API
        const response = await fetch("/process_login", {
            method: "POST",
            body: JSON.stringify(loginData), // Convert data to JSON string
            headers: {
                "Content-Type": "application/json", // Add content type header for JSON data
            },
        });

        // Parse the JSON response from the backend
        const data = await response.json();

        // Check if there is an error in the response data
        if ("error" in data) {
            // Show the error message if the ID is invalid
            document.getElementById("errorMessage").style.display = "block";
        } else {
            // Redirect to the camera page with the entered name and ID as query parameters
            window.location.href = data.redirect_url;
        }
    });
</script>

</body>
</html>
